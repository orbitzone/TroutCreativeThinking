var sameHeight=function(a){var b,c=0,d=0,e=new Array,f=0;$(a).height("auto"),$(a).each(function(){if(b=$(this),f=b.offset().top,d!=f){for(currentDiv=0;currentDiv<e.length;currentDiv++)e[currentDiv].height(c);e.length=0,d=f,c=b.height(),e.push(b)}else e.push(b),c=c<b.height()?b.height():c;for(currentDiv=0;currentDiv<e.length;currentDiv++)e[currentDiv].height(c)})},player={autoplay:!1,active:"",obj:{},init:function(a,b){if("undefined"==typeof YT||"undefined"==typeof YT.Player){window.onYouTubeIframeAPIReady=function(){player.obj[a]=player.loadPlayer(a,b),player.autoplay&&player.play(a)};
//This code loads the IFrame Player API code asynchronously.
var c=document.createElement("script");c.src="https://www.youtube.com/iframe_api";var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(c,d)}else if("undefined"!=typeof player.obj[a]){var e=player.obj[a];e.getVideoData().video_id!=b?(player.obj[a].loadVideoById(b),player.autoplay&&player.play(a)):player.autoplay&&player.play(a)}else player.obj[a]=player.loadPlayer(a,b)},loadPlayer:function(a,b){return player.active=a,new YT.Player(a,{videoId:b,width:790,height:444,playerVars:{autoplay:player.autoplay,showinfo:0,modestbranding:0,rel:0},events:{onReady:function(b){1==player.autoplay&&player.play(a),$(window).resize()},onStateChange:function(a){a.data==YT.PlayerState.PLAYING&&$.each(player.obj,function(b){b!=a.target.m.id&&"undefined"!=typeof player.obj[b].stopVideo&&player.obj[b].stopVideo()})}}})},play:function(a){var b=player.obj[a];"undefined"!=typeof b.playVideo&&b.playVideo()},stop:function(a){if("undefined"!=typeof a){var b=player.obj[a];"undefined"!=typeof b.stopVideo?b.stopVideo():player.autoplay=!1}else $.each(player.obj,function(a){"undefined"!=typeof player.obj[a].stopVideo&&player.obj[a].stopVideo()})}},grant={init:function(){this.countdown(),$("#grant").hasClass("news")&&this.news(),$("#grant").hasClass("homepage")&&this.homepage(),$("#grant").hasClass("projects")&&this.projects(),$("#grant").hasClass("apply-now")&&this.applyNow(),$(".winners-slider").length>0&&this.winnersSlider()},homepage:function(){if($(".grid").length>0)var a=new Masonry(".grid",{itemSelector:".grid-item",transitionDuration:0});$(window).resize(),$("#feed").imagesLoaded().always(function(a){$(window).resize()}),$(".homepage-video").length>0&&($(".homepage-video").slick({swipe:!1,swipeToSlide:!1,touchMove:!1}),$(".video .play-pause-video").on("click",function(){if($(".homepage-video").parent().toggleClass("active"),$(".homepage-video").parent().hasClass("active")){$(".homepage-video").slick("slickGoTo",1);var a=$("#the-player"),b=a.data("video");b&&(player.autoplay=!0,player.init("the-player",b))}else $(".homepage-video").slick("slickGoTo",0),player.stop()}),$(".video-slider-wrap").css({opacity:1})),$(window).on("resize",function(){var b=0,c=0;$("#feed .item").height(""),$("#feed .item").each(function(){$(this).hasClass("double")?$(this).outerHeight()>b&&(b=$(this).outerHeight()):$(this).outerHeight()>c&&(c=$(this).outerHeight())}),b>2*c?($("#feed .item.double").outerHeight(b),$("#feed .item.single").outerHeight(b/2)):($("#feed .item.double").outerHeight(2*c),$("#feed .item.single").outerHeight(c)),a.layout()})},projects:function(){function a(a){$(".cards-slider .card.active,.cards-slider .card.show").addClass("leave").removeClass("active").removeClass("show"),clearTimeout(c),clearTimeout(d),c=setTimeout(function(){$(".cards-slider .card.leave").removeClass("leave"),$(".cards-slider ."+a).addClass("show"),d=setTimeout(function(){$(".cards-slider .show").addClass("active").removeClass("show")},300)},300)}this.news(),/*$('aside a.top-link').on('click', function(){
      //$(this).parent().addClass('active');
      if($(this).hasClass('open')){
        $(this).removeClass('open');
        $(this).parent().find('ul').slideUp();
      }else{
        $(this).addClass('open');
        $(this).parent().find('ul').slideDown();  
      }      
      return false;
    });*/
$(".map svg .dot").each(function(){var a=$(this).find("circle"),b=a.attr("cx"),c=a.attr("cy");$(this).find("g,circle,path").css({"-webkit-transform-origin":b+"px "+c+"px","-moz-transform-origin":b+"px "+c+"px","-ms-transform-origin":b+"px "+c+"px","-o-transform-origin":b+"px "+c+"px","transform-origin":b+"px "+c+"px"})}),$(".map svg .dot.active").each(function(){var a=$(this).find("circle").attr("cx"),b=$(this).find("circle").attr("cy");$(this).find("circle").attr("transform","translate("+a+" "+b+") scale(2) translate(-"+a+" -"+b+")")}),$(".cards-slider").imagesLoaded().always(function(a){$(window).resize()}),$(".person-video").length>0&&($(".person-video").slick({swipe:!1,swipeToSlide:!1,touchMove:!1}),$(".video .play-pause-video").on("click",function(){if($(".person-video").parent().toggleClass("active"),$(".person-video").parent().hasClass("active")){$(".person-video").slick("slickGoTo",1);var a=$("#the-player"),b=a.data("video");b&&(player.autoplay=!0,player.init("the-player",b))}else $(".person-video").slick("slickGoTo",0),player.stop()})),$(document).on("click",".map .dot",function(){var b=$(this).data("person");a(b),$(".map .dot").attr("class","dot"),$(".map .dot circle").attr("transform",""),$(this).attr("class","dot active");var c=$(this).find("circle").attr("cx"),d=$(this).find("circle").attr("cy");$(this).find("circle").attr("transform","translate("+c+" "+d+") scale(2) translate(-"+c+" -"+d+")")});var b=!1;$(window).on("resize",function(){$(window).width()<768?b===!1&&($(".winners-slider").slick("slickFilter",".item-slide"),b=!0):($(".winners-slider").slick("slickUnfilter"),b=!1),$(".card").height("");var a=0;$(".card").each(function(){$(this).outerHeight()>a&&(a=$(this).outerHeight())}),$(".card").outerHeight(a)}),$(".winners-slider").imagesLoaded().always(function(a){$(window).resize()}),$(".winners-slider .slide").on("click",function(){$(".winners-slider .slide").removeClass("active"),$(this).addClass("active");var b=$(this).data("person");b&&(a(b),$(".map .dot").attr("class","dot"),$(".map .dot[data-person="+b+"]").attr("class","dot active"))});var c=null,d=null},news:function(){$(".slider-thumbs").slick({prevArrow:'<button type="button" class="slick-prev"><svg viewBox="0 0 26 46" id="shape-arrow-left"><title>arrow-left</title> <g id="arrow-left-arrow-left"> <path d="M24.4,0.6C24.1,0.2,23.5,0,23,0c-0.5,0-1,0.2-1.4,0.6l-21,21c-0.8,0.8-0.8,2.1,0,2.8l21,21c0.8,0.8,2.1,0.8,2.8,0c0.8-0.8,0.8-2.1,0-2.8L4.9,23L24.4,3.4C25.2,2.6,25.2,1.4,24.4,0.6z"/> </g> </svg></button>',nextArrow:'<button type="button" class="slick-next"><svg viewBox="0 0 26 46" id="shape-arrow-right"><title>arrow-right</title> <g id="arrow-right-arrow-right"> <path d="M1.6,45.4C2,45.8,2.5,46,3,46c0.5,0,1-0.2,1.4-0.6l21-21c0.8-0.8,0.8-2.1,0-2.8l-21-21c-0.8-0.8-2.1-0.8-2.8,0c-0.8,0.8-0.8,2.1,0,2.8L21.2,23L1.6,42.6C0.8,43.4,0.8,44.7,1.6,45.4z"/> </g> </svg></button>',slidesToScroll:4,slidesToShow:4,asNavFor:".slider-main",focusOnSelect:!0}),$(".slider-main").slick({prevArrow:'<button type="button" class="slick-prev"><svg viewBox="0 0 26 46" id="shape-arrow-left"><title>arrow-left</title> <g id="arrow-left-arrow-left"> <path d="M24.4,0.6C24.1,0.2,23.5,0,23,0c-0.5,0-1,0.2-1.4,0.6l-21,21c-0.8,0.8-0.8,2.1,0,2.8l21,21c0.8,0.8,2.1,0.8,2.8,0c0.8-0.8,0.8-2.1,0-2.8L4.9,23L24.4,3.4C25.2,2.6,25.2,1.4,24.4,0.6z"/> </g> </svg></button>',nextArrow:'<button type="button" class="slick-next"><svg viewBox="0 0 26 46" id="shape-arrow-right"><title>arrow-right</title> <g id="arrow-right-arrow-right"> <path d="M1.6,45.4C2,45.8,2.5,46,3,46c0.5,0,1-0.2,1.4-0.6l21-21c0.8-0.8,0.8-2.1,0-2.8l-21-21c-0.8-0.8-2.1-0.8-2.8,0c-0.8,0.8-0.8,2.1,0,2.8L21.2,23L1.6,42.6C0.8,43.4,0.8,44.7,1.6,45.4z"/> </g> </svg></button>',focusOnSelect:!0}),$(".news").imagesLoaded().always(function(a){$(window).resize()}),$(window).on("resize",function(){sameHeight(".news article")}),$(".slider-thumbs").length>0&&$(window).on("resize",function(){var a=$(".slider-thumbs .slide").width()/189*144;$(".slider-thumbs .slide").height(a)}).resize()},winnersSlider:function(){$(".winners-slider").slick({prevArrow:'<button type="button" class="slick-prev"><svg viewBox="0 0 26 46" id="shape-arrow-left"><title>arrow-left</title> <g id="arrow-left-arrow-left"> <path d="M24.4,0.6C24.1,0.2,23.5,0,23,0c-0.5,0-1,0.2-1.4,0.6l-21,21c-0.8,0.8-0.8,2.1,0,2.8l21,21c0.8,0.8,2.1,0.8,2.8,0c0.8-0.8,0.8-2.1,0-2.8L4.9,23L24.4,3.4C25.2,2.6,25.2,1.4,24.4,0.6z"/> </g> </svg></button>',nextArrow:'<button type="button" class="slick-next"><svg viewBox="0 0 26 46" id="shape-arrow-right"><title>arrow-right</title> <g id="arrow-right-arrow-right"> <path d="M1.6,45.4C2,45.8,2.5,46,3,46c0.5,0,1-0.2,1.4-0.6l21-21c0.8-0.8,0.8-2.1,0-2.8l-21-21c-0.8-0.8-2.1-0.8-2.8,0c-0.8,0.8-0.8,2.1,0,2.8L21.2,23L1.6,42.6C0.8,43.4,0.8,44.7,1.6,45.4z"/> </g> </svg></button>',slidesToShow:5,slidesToScroll:4,infinite:!0,variableWidth:!0,responsive:[{breakpoint:1024,settings:{slidesToShow:3,slidesToScroll:3,infinite:!0,dots:!0}},{breakpoint:768,settings:{slidesToShow:1,slidesToScroll:1,infinite:!0,dots:!0,variableWidth:!1}}]})},applyNow:function(){function a(){var a=!1;return $(".step1 .error").remove(),$(".step1 input[required]").each(function(){""==$(this).val()&&($(this).parent().append('<div class="error">This field is required</div>'),a=!0)}),!a}function b(){var a=!1;return $(".step2 .error").remove(),$(".step2 textarea[required]").each(function(){""==$(this).val()&&($(this).parent().append('<div class="error">This field is required</div>'),a=!0)}),!a}function c(){var a=!1;return $(".step3 .error").remove(),$(".step3 input[required]").each(function(){""==$(this).val()&&($(this).parent().append('<div class="error">This field is required</div>'),a=!0)}),!a}function d(d){var e=1*d-1,f=!1;f=1==e?a():2==e?b():c(),f&&($(".steps-list button, .steps .step").removeClass("active"),$(".steps-list button[data-step="+d+"]").addClass("active"),$(".steps-navigation .previous").hide(),$(".steps-navigation .next").hide(),$(".steps-navigation .submit").hide(),1==d?$(".steps-navigation .next").show():2==d?($(".steps-navigation .previous").show(),$(".steps-navigation .next").show()):($(".steps-navigation .previous").show(),$(".steps-navigation .submit").show()),$(".steps .step"+d).addClass("active"))}$(document).on("click",".upload-button",function(){$(this).parent().find("input").focus().trigger("click")});var e={};$(document).on("change",".upload-input input",function(a){
// reset
$(this).parent().parent().find(".error").remove(),e.fileName=null,
// file type?
$("html").hasClass("lt-ie9")||$("html").hasClass("lt-ie8")||navigator.appVersion.indexOf("MSIE 9.")!=-1?($(this).parent().find(".upload-filename").text("Image added"),e.fileType="image",$(this).addClass("uploaded")):(
// video or image or invalid file type
e.fileType=$(this)[0].files[0].type,e.fileName=$(this)[0].files[0].name,
//if(app.fileType.indexOf("video") > -1) app.fileType = "video";
e.fileType.indexOf("image")>-1?e.fileType="image":e.fileType="invalid","invalid"!=e.fileType?($(this).parent().find(".upload-filename").text(e.fileName),$(this).addClass("uploaded")):$(this).parent().parent().append('<div class="error" style="display:block;" data-num="'+e.numberFiles+'">Invalid file type selected: '+e.fileName+"</div>"))}),$(".steps-list button").on("click",function(){var a=$(this).data("step");d(a)}),$(".steps-navigation button[type=button]").on("click",function(){var a=$(".steps-list button.active").data("step");$(this).hasClass("previous")?a-=1:a+=1,d(a)}),$(".form form").on("submit",function(a){a.preventDefault();var b={"first-name":$("#apply-form input[name=first-name]").val(),"last-name":$("#apply-form input[name=last-name]").val(),"account-number":$("#apply-form input[name=account-number]").val(),email:$("#apply-form input[name=email]").val(),"name-and-location":$("#apply-form textarea[name=name-and-location]").val(),"beneficiaries-of-the-project":$("#apply-form textarea[name=beneficiaries-of-the-project]").val(),"date-of-planned-work":$("#apply-form textarea[name=date-of-planned-work]").val(),"reason-for-the-project":$("#apply-form textarea[name=reason-for-the-project]").val(),"what-is-the-desired-outcome":$("#apply-form textarea[name=what-is-the-desired-outcome]").val()};return $("#apply-form .the-form").slideUp(),$("#apply-form .loading").slideDown(),setTimeout(function(){$.ajax({url:"",data:b,success:function(){$("#apply-form").find("input[type=text], input[type=email], textarea").each(function(){var a=$(this).attr("name");$(".details-"+a).html($(this).val())});var a=1;$("#apply-form").find(".upload-filename").each(function(){$(".details-file-"+a).html($(this).html()),a+=1}),$("#apply-form .loading").slideUp(),$("#apply-intro").slideUp(),$("#apply-form").slideUp(),$("#thank-you").slideDown()},error:function(){}})},2e3),!1})},countdown:function(){
// Parse countdown string to an object
function a(a){var b=a.match(g),d={};return c.forEach(function(a,c){d[a]=b[c]}),d}
// Return the time components that diffs
function b(a,b){var d=[];return c.forEach(function(c){a[c]!==b[c]&&d.push(c)}),d}var c=["days","hours","minutes","seconds"],d=$("#countdown").data("date"),e="00:00:00:00:00",f="00:00:00:00:00",g=/([0-9]{2})/gi,h=a(e);c.forEach(function(a,b){$("#countdown").find("."+a+" .curr span").text(h[a]),$("#countdown").find("."+a+" .next span").text(h[a]),$("#countdown").find("."+a+" .label span").text(a)}),$("#countdown").css({opacity:1}),$("#countdown").countdown(d,function(c){var d,g=c.strftime("%D:%H:%M:%S");g!==f&&(e=f,f=g,
// Setup the data
d={curr:a(e),next:a(f)},
// Apply the new values to each node that changed
b(d.curr,d.next).forEach(function(a){var b=".%s".replace(/%s/,a),c=$("#countdown").find(b);
// Update the node
c.removeClass("flip"),c.find(".curr span").text(d.curr[a]),c.find(".next span").text(d.next[a]),
// Wait for a repaint to then flip
setTimeout(function(){c.addClass("flip")},50)}))})}};!function(a){a(function(){grant.init()})}(jQuery);